<!-- 
 * #%L
 * Over-the-air deployment library
 * %%
 * Copyright (C) 2012 SAP AG
 * %%
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * #L%
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
    <title>Over The Air Deployment</title>

		<script type="text/javascript">
		  //REMOVING IFRAME
		  try {
		    //Exception when accessing outer frame parent location from different domain
		    var parentHref = parent.location.href;
		    //No Exception, either frame removed already or using OTA Service in same domain
			if(parentHref != document.location.href) {
			  parent.location.href = document.location.href;
			}
		  } catch (e) {
		    //Get rid of iFrame, reload window with iFrame page
			parent.location.href = document.location.href;
		  }
		</script>

		<style>
			body {
				font-family: Sans Serif, Helvetica, Arial;
				font-size: 10pt;
				padding: 30px;
				background-color: #e6e6e6;
				color: #000000;
			}
			
			h1,h2,h3 {
				text-shadow: 3px 3px 5px #959595;
			}
			
			.maincontainer{
				min-width: 500px;
				max-width: 650px;
				margin: 0 auto; /*Center container on page*/
				text-align: right;
			}
								
			.contentbox
			{
				border-top-left-radius: 4px;
				border-top-right-radius: 4px;
				border-bottom-right-radius: 4px;
				border-bottom-left-radius: 4px;
				background-color: #ffffff;
				padding-top: 1px;
				padding-left: 20px;
				padding-right: 20px;
				padding-bottom: 20px;
				border-style: solid;
				border-width: 1px;
				border-color: #a0a0a0;
				box-shadow: 1px 1px 5px #818181;
				text-align: right;
			}

            input { border-radius: 4px; box-shadow: 1px 1px 3px #d0d0d0;}
			
			a.button {
				border-top-left-radius: 20px;
				border-top-right-radius: 20px;
				border-bottom-right-radius: 20px;
				border-bottom-left-radius: 20px;
				padding-top: 10px;
				padding-left: 20px;
				padding-right: 20px;
				padding-bottom: 10px;
				border-style: solid;
				border-width: 1px;
				border-color: #a0a0a0;
				box-shadow: 1px 1px 5px #818181;
			}
			
            a.button:link, a.button:visited {
				color: #ffffff;
				font-weight: bold;
				text-decoration: none;
				background-color: #08C;
			}
            a.button:hover {
				color: #ffffff;
				font-weight: bold;
				text-decoration: none;
				background-color: #06A;
			}
            a.button:active {
				color: #ffffff;
				font-weight: bold;
				text-decoration: none;
				background-color: #666;
				box-shadow: 1px 1px 10px #818181;
			}
			
			a.disabled:link, a.disabled:visited, a.disabled:hover, a.disabled:active {
				background-color: #cccccc;
				border-color: #cccccc;
				cursor: default;
			}

			a.qrcodeToggleLink:link, a.qrcodeToggleLink:visited, a.qrcodeToggleLink:hover, a.qrcodeToggleLink:active {
				font-size: 7pt;
				padding-bottom: 5px;
				color: #888888;
			}
			
			.black_overlay{
    			display: none;
    			position: absolute;
    			top: 0%;
    			left: 0%;
    			width: 100%;
    			height: 100%;
    			background-color: black;
    			z-index:1001;
				-moz-opacity: 0.8;
				opacity:.80;
				filter: alpha(opacity=80);
			}
		</style>
		
		<script type="text/javascript" src="http://code.jquery.com/jquery-latest.pack.js"></script>
		
		<script type="text/javascript">
			
			var lastZIndex = 0;
			
			function isIDevice() {
				var agent = navigator.userAgent;
				if(agent.indexOf("iPad") !== -1) return true;
				if(agent.indexOf("iPhone") !== -1) return true;
				return false;
			}
			
			$(document).ready(function() {
				if(isIDevice()) {
				  $("#otaButtonDiv").css("display", "inline");
				  $("#leftTd").attr("colspan", "2");
				  $("#rightTd").remove();
				} else {
				  $("#otaQrButton").css("display", "inline");
				  $("#ipaButton").css("display", "inline");
				}
			});
			
			function showLightBoxElement(element) {
				$("#blackOverlay").css("display", "block");
				$("#blackOverlay").click(hideLightBoxElement);
				lastElement = element;
				lastZIndex = element.css("z-index");
				element.css("z-index", "1002");
				element.css("display", "block");
				element.click(hideLightBoxElement);
			}

			function hideLightBoxElement() {
				$("#blackOverlay").css("display", "none");
				lastElement.css("z-index", lastZIndex);
				lastElement.css("display", "none");
			}
			
		</script>
		
</head>
<body>

<div class="maincontainer">

<a class="qrcodeToggleLink" href="#" onClick="showLightBoxElement($('#installPageQrDiv'))">Show Install Page QRCode</a>

<div class="contentbox">

<table cellpadding="0" cellspacing="0" width="99%">
  <tbody><tr>
    <td colspan="2" height="1px" style="padding:15px;text-align:left;vertical-align:top">
	  <h2>Install App: $title</h2>
  </tr>
  <tr>
    <td id="leftTd" style="padding:15px" align="center" valign="top" width="50%">
	  <div id="otaButtonDiv" style="display:none">
		<a id="otaButton" class="button" href='itms-services:///?action=download-manifest&url=$plistUrl'>Install Over-The-Air</a><br/><br/>
		<a id="otaQrLink" class="qrcodeToggleLink" href="#" onClick="showLightBoxElement($('#otaQrDiv'))">Show OTA Install QRCode</a>
	  </div>
	  <a id="otaQrButton" style="display:none" class="button" href="#" onClick="showLightBoxElement($('#otaQrDiv'))">Show OTA Install QRCode</a>
	</td>
    <td id="rightTd" style="padding:15px" align="center"  valign="top" width="50%">
	  <a id="ipaButton" style="display:none" class="button" href='$ipaUrl'>Install via iTunes</a>
    </td>
  </tr>
</tbody></table>


</div>
</div>



<!-- Dynamic elements: -->

<div id="installPageQrDiv" style="position:absolute;top:50px;left:240px;display:none">
  <img id="installPageQr" src="$htmlQrcodeUrl"/>
</div>

<div id="otaQrDiv" style="position:absolute;top:50px;left:240px;display:none">
	<img border="0" src="$plistUrl?action=qrcode"/>
</div>

<div id="blackOverlay" class="black_overlay"></div>

</body>
</html>